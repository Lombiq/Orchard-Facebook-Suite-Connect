@using System.Web.Mvc;
@{
    string returnUrl = Context.Request.QueryString["ReturnUrl"] ?? Context.Request.RawUrl;

    if (!Model.IsAuthenticated || Model.IsAuthenticated && !Model.IsConnected)
    {
        returnUrl = Url.Action("Connect", "Connect", new { Area = "Piedone.Facebook.Suite.Connect", ReturnUrl = returnUrl });
    }
}
@{
    Script.Require("FacebookConnect").AtHead();
    Style.Require("FacebookConnect");
}
@if (!Model.IsAuthenticated)
{
    @Display(New.FacebookConnectNotAuthenticated(Permissions: Model.ContentPart.Permissions, ReturnUrl: returnUrl))
}
else if (Model.IsConnected)
{
    @Display(New.FacebookConnectAuthenticated(AuthenticatedFacebookUser: Model.AuthenticatedFacebookUser, ReturnUrl: returnUrl))
}
else
{
    @Display(New.FacebookConnectAuthenticatedNotConnected(Permissions: Model.ContentPart.Permissions, ReturnUrl: returnUrl))
}