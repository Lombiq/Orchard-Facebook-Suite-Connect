@using System.Web.Mvc;
@{
    string returnUrl = Context.Request.QueryString["ReturnUrl"] ?? Context.Request.RawUrl;

    if (!Model.IsAuthenticated)
    {
        returnUrl = Url.Action("Connect", "Connect", new { Area = "Piedone.Facebook.Suite.Connect", ConnectId = Model.ContentPart.Id, ReturnUrl = returnUrl });
    }
    else
    {
        returnUrl = Url.Action("LogOff", new { Controller = "Account", Area = "Orchard.Users", ReturnUrl = returnUrl });
    }
}
@{
    Script.Require("FacebookConnect").AtHead();
    Style.Require("FacebookConnect");
}
@if (!Model.IsAuthenticated)
{
    @Display(New.FacebookConnectNotAuthenticated(Permissions: Model.ContentPart.Permissions, ReturnUrl: returnUrl))
}
else if (Model.IsConnected)
{
    @Display(New.FacebookConnectAuthenticated(AuthenticatedFacebookUser: Model.AuthenticatedFacebookUser, ReturnUrl: returnUrl))
}
else
{
    @Html.ActionLink(T("Sign out to log in with Facebook").ToString(), "LogOff", new { Controller = "Account", Area = "Orchard.Users", ReturnUrl = Context.Request.RawUrl }, new { @class = "piedone-facebook-suite-connect sign-out-to-connect-with-facebook-link" })
}